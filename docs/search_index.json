[["index.html", "Introduction to Environmental Data Science: Final Project Preface", " Introduction to Environmental Data Science: Final Project Amanda Hastings 2022-03-23 Preface This book contains six different projects completed in ESS580: Introduction to Environmental Data Science taught by Dr. Matt Ross and Dr. Nathan Mueller at Colorado State University. Each chapter details the purpose, data acquisition, analyses, and results of an individual project completed in the 2022 spring semester. For each project, Dr. Matt Ross and/or Dr. Nathan Mueller wrote the preliminary code and outlined project objectives. Amanda Hastings completed the remaining portions of each project and compiled this book. "],["geospatial-analysis.html", "Chapter 1 Geospatial Analysis 1.1 Introduction 1.2 Methods 1.3 Results 1.4 References", " Chapter 1 Geospatial Analysis 1.1 Introduction This project served as an introduction to spatial analysis in R and consisted of two parts. In part one, we utilized data from the LAGOS-NE Locus module to investigate the spatial distribution and size of lakes in three midwestern US states: Illinois, Iowa, and Minnesota. LAGOS-NE is a geospatial and temporal database of lake ecological context and water quality for 17 states in the midwestern and northeastern United States (Soranno and Cheruvelil 2017). Project objectives: Use mapview package to create interactive maps Utilize sf package to work with geospatial vector data Assess the distribution of lake size across states 1.2 Methods Data Acquisition We utilized the LAGOSNE R package to retrieve LAGOS-NE data. #Download LAGOS data # LAGOSNE::lagosne_get(dest_folder = LAGOSNE:::lagos_path()) #Load in LAGOS data lagos &lt;- lagosne_load() #Parse out lake centroid information lake_centers &lt;- lagos$locus # load(&#39;lake_centers.Rdata&#39;) Data Processing #Create spatial object for lakes spatial_lakes &lt;- st_as_sf(lake_centers,coords=c(&#39;nhd_long&#39;,&#39;nhd_lat&#39;), crs=4326) %&gt;% st_transform(2163) #Subset number of lakes for plotting subset_spatial &lt;- spatial_lakes %&gt;% slice(1:100) subset_baser &lt;- spatial_lakes[1:100,] #Dynamic mapviewer for LAGOS lake subset mapview(subset_spatial, layer.name=&quot;LAGOS lake subset&quot;) Figure 1. A subset of lakes within the LAGOS dataset for an introduction to dynamic mapping with the mapview R package. #Create states variable states &lt;- us_states() #Select only Minnesota from states data minnesota &lt;- states %&gt;% filter(name == &#39;Minnesota&#39;) %&gt;% st_transform(2163) #Subset lakes based on spatial position minnesota_lakes &lt;- spatial_lakes[minnesota,] 1.3 Results #Plot the first 1000 Minnesota lakes #Color by lake area in hectares minnesota_lakes %&gt;% arrange(-lake_area_ha) %&gt;% slice(1:1000) %&gt;% mapview(.,zcol = &#39;lake_area_ha&#39;, at=c(0,500,1500,3000,7500,15000,30000,65000,125000),layer.name=&#39;Lake area (ha)&#39;)+ mapview(minnesota,layer.name=&quot;Minnesota&quot;, alpha.regions=0.35, col.regions=&quot;#fcf87f&quot;) Figure 2. Interactive map of Minnesota Lakes, colored by lake area in hectares. #Create interactive plot of Iowa and Illinois lakes #Color by lake area in hectares istate_lakes %&gt;% arrange(-lake_area_ha) %&gt;% slice(1:1000) %&gt;% mapview(., zcol = &#39;lake_area_ha&#39;, at=c(0,100,250,500,1000,2500,5000,10000), layer.name=&#39;Lake area (ha)&#39;)+ mapview(i_states,zcol=&#39;name&#39;, alpha.regions=0.35, col.regions=c(&quot;#DAA520&quot;,&quot;#9F2B68&quot;), layer.name=F) Figure 3. Interactive map of Iowa and Illinois lakes, colored by lake area in hectares. Figure 4. Distribution of Minnesota lake size in hectares. Figure 5. Distribution of Iowa lake size in hectares. Figure 6. Distribution of Illinois lake size in hectares. In our analysis of the spatial distribution and size of lakes in Minnesota, Iowa, and Illinois, we found Minnesota exceeded the other two states both in the number of sites included in the LAGOS dataset and the size of lakes recorded in each state. There are 16446 sites in the LAGOS dataset for Illinois and Iowa combined. Meanwhile, there are 29038 Minnesota sites, exceeding the number of sites in Illinois/Iowa by 12572 sites. Furthermore, Minnesota lake size was generally greater than Iowa and Illinois lake size. Though, the distributions of lake size for all states are positively skewed. Additional data sources Additional useful sources for assessing reservoir and lake size: *The Global Lake area, Climate, and Population (GLCP) dataset is comprised of lake surface area data (from the datasets listed below), as well as temperature, precipitation, and population data (Meyer et al. 2020). *The HydroLAKES dataset combines information from multiple lake datasets, including NASA SRTM, Water Body Data, and the Global Lakes and Wetlands Database (Meyer et al. 2020). This dataset consists of shapefiles with attributes such as lake surface area, total volume, average depth, geographic coordinates of pour points, and more (Meyer et al. 2020). *The Global Surface Water Dataset, derived from LANDSAT imagery and hosted by the Joint Research Centre (JRC), provides information regarding surface water area for lakes, as well as rivers, streams, and wetlands (Meyer et al. 2020). A subset of this data based upon yearly water classification history is available via Google Earth Engine (Meyer et al. 2020). *Also, the Central Midwest Water Science Center is another resource, for Iowa and Illinois lake data specifically. 1.4 References Meyer, MF, Labou, SG, Cramer, AN, Brousil, MR, &amp; Luff, BT. (2020). The global lake area, climate, and population dataset. Scientific Data, 7(1), 112. https://doi.org/10.1038/s41597-020-0517-4 Soranno, P. and K. Cheruvelil. (2017). LAGOS-NE-LIMNO v1.087.1: A module for LAGOS-NE, a multi-scaled geospatial and temporal database of lake ecological context and water quality for thousands of U.S. Lakes: 1925-2013 ver 2. Environmental Data Initiative. https://doi.org/10.6073/pasta/56cc5f1f753d48edfea170a5401dd6df "],["geospatial-analysis-water-quality.html", "Chapter 2 Geospatial Analysis: Water Quality 2.1 Introduction 2.2 Methods 2.3 Results 2.4 2) What states have the most data? 2.5 References", " Chapter 2 Geospatial Analysis: Water Quality 2.1 Introduction This chapter describes part two of our geospatial analysis project. For part two, we expanded upon our intial analysis and used data from the LAGOS-NE Limno module for in-situ water quality. We focused on two water quality metrics: chlorophyll a and secchi disk depth. 2.2 Methods Similar to Geospatial Analysis part one, we retrieved lake water quality data using the LAGOSNE R package. Data Acquisition #Select clarity variables only from LAGOS water quality data clarity_only &lt;- nutr %&gt;% select(lagoslakeid,sampledate,chla,doc,secchi) %&gt;% mutate(sampledate = as.character(sampledate) %&gt;% ymd(.)) Data Processing #Filter data to remove NA values from variables of interest: Chla and Secchi Disk Depth chla_secchi &lt;- clarity_only %&gt;% filter(!is.na(chla), !is.na(secchi)) #Include only lakes with at least 200 observations for Chla and Secchi Disk Depth chla_secchi_200 &lt;- chla_secchi %&gt;% group_by(lagoslakeid) %&gt;% mutate(count = n()) %&gt;% filter(count &gt; 200) #Join chla/secchi data to spatial lake data with observations &gt;200 spatial_200 &lt;- inner_join(spatial_lakes,chla_secchi_200 %&gt;% distinct(lagoslakeid,.keep_all=T), by=&#39;lagoslakeid&#39;) #Calculate mean chla and secchi by lake mean_values_200 &lt;- chla_secchi_200 %&gt;% #Group by lake id group_by(lagoslakeid) %&gt;% #Calculate mean chla and secchi per lake id summarize(mean_chl = mean(chla,na.rm=T), mean_secchi=mean(secchi,na.rm=T)) %&gt;% #Filter NAs filter(!is.na(mean_chl), !is.na(mean_secchi)) %&gt;% #Calculate log base 10 of the mean_chl mutate(log10_mean_chl = log10(mean_chl)) #Join mean chla/secchi data to spatial lake data mean_spatial &lt;- inner_join(spatial_lakes,mean_values_200, by=&#39;lagoslakeid&#39;) 2.3 Results Water clarity: chlorophyll a and secchi disk depth Figure 1. Map visualizing (log transformed) average chlorophyll a concentrations across lakes. Includes lakes where chlorophyll a observations exceed 200 within the LAGOS Limno dataset (n &gt; 200). Figure 2. Chlorophyll a and secchi disk depth measurements across lakes (number of observations exceeding 200). I used a test of correlation to assess the relationship between chlorophyll a concentrations and secchi disk depths in lakes with greater than 200 observations of each variable. There is a negative correlation between secchi disk depth and chlorophyll a levels, where shallower secchi disk depths are associated with higher chlorophyll a levels (p-value = 2.2e-16). High cholorphyll a concentrations are associated with high density(s) of photosynthetic organisms, such as algae. Meanwhile, secchi disks are used to assess water turbidity, where the depth of disk disappearance indicates the transparency of the water (Fuller and Minnerick 2007). Where algae abundance is high, the depth where light can penetrate a water body diminishes; thus, secchi disk depth decreases (Fuller and Minnerick 2007). #Filter by 200 or more observations #Calculate the mean secchi depth by lake secchi200 &lt;- chla_secchi %&gt;% group_by(lagoslakeid) %&gt;% mutate(count = n()) %&gt;% filter(count &gt; 200) %&gt;% summarize(mean_secchi = mean(secchi)) #Add geographic information, joining by lagoslakeid secchi200_locus &lt;- inner_join(secchi200, lake_centers, by=&#39;lagoslakeid&#39;) %&gt;% select(lagoslakeid, nhd_long, nhd_lat, mean_secchi) #Create a spatial object with lagoslakeid and mean secchi data spatial_secchi200 &lt;- st_as_sf(secchi200_locus,coords=c(&#39;nhd_long&#39;,&#39;nhd_lat&#39;), crs=4326) #Visualize secchi data within interactive plot/map mapview(spatial_secchi200, zcol=&#39;mean_secchi&#39;, layer.name=&#39;Secchi Disk Depth (m)&#39;) &lt;Figure 3. Map visualizing average secchi disk depths across lakes. Includes lakes where secchi disk depth observations exceed 200 within the LAGOS Limno dataset (n &gt; 200). I did not find an exceptionally strong spatial pattern in secchi disk depth in lakes with at least 200 observations, given the number of observations above 200 is small. However, the patch of lakes near/surrounding the Minneapolis-Saint Paul sprawl in Minnesota have broadly shallower secchi disk depths. Meanwhile, lakes in more remote areas in northern Wisconsin and near the Adirondacks in New York have generally deeper secchi disk depths. Despite a weaker spatial pattern, it is probable lakes within more remote areas have generally deeper secchi depths and urban areas shallower depths. 2.4 2) What states have the most data? 2.4.1 2a) First you will need to make a lagos spatial dataset that has the total number of counts per site. #Create lagos spatial dataset with total number of counts per site site_counts &lt;- chla_secchi %&gt;% group_by(lagoslakeid) %&gt;% mutate(count = n()) #Add geographic information to site counts data geo_counts &lt;- inner_join(site_counts,lake_centers, by= &#39;lagoslakeid&#39;)%&gt;% select(lagoslakeid,nhd_long,nhd_lat, count, secchi, chla) #Create spatial object for lagos dataset spatial_counts &lt;- st_as_sf(geo_counts,coords=c(&#39;nhd_long&#39;,&#39;nhd_lat&#39;), crs=4326) 2.4.2 2b) Second, you will need to join this point dataset to the us_boundaries data. #Use a spatial join to combine point dataset and us_boundaries data #Parse out state boundaries from us_boundaries data states &lt;- us_states() #Use spatial join to overlay point dataset (original lagos spatial dataset) and state boundaries overlay &lt;- st_join(spatial_counts,states) 2.4.3 2c) Then you will want to group by state and sum all the observations in that state and arrange that data from most to least total observations per state. #Group by state and sum number of observations by state summed_overlay &lt;- overlay %&gt;% group_by(state_name) %&gt;% summarize(sum_count = sum(count)) %&gt;% arrange(desc(sum_count)) #Print first six rows of dataframe knitr::kable(head(summed_overlay)) state_name sum_count geometry Minnesota 6397053 MULTIPOINT ((-91.7611 48.07 Vermont 2800140 MULTIPOINT ((-71.69262 44.4 New York 2434082 MULTIPOINT ((-73.85454 44.4 Wisconsin 2045199 MULTIPOINT ((-87.15812 45.0 Rhode Island 1989837 MULTIPOINT ((-71.58223 41.9 Missouri 1372894 MULTIPOINT ((-95.58194 40.4 #Plot/map number of observations per state mapview(summed_overlay,zcol=&#39;sum_count&#39;, layer.name = &#39;Observations per state&#39;) The top five states with the most data include: Minnesota, Vermont, New York, Wisconsin, and Rhode Island. 2.5 References Fuller, LM &amp; Minnerick, RJ (2007). Predicting Water Quality by Relating Secchi-Disk Transparency and Chlorophyll a Measurements to Landsat Satellite Imagery for Michigan Inland Lakes, 20012006. USGS, August 2007, 14. [http://pubs.usgs.gov/fs/2007/3022/pdf/FS2007-3022.pdf] "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
